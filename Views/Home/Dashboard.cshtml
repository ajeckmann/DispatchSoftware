@model List<Incident>

    <!DOCTYPE html>
    <html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>Document</title>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

        <script>
            console.log($);
            $(document).ready(function () {

                $('h3').click(function () {
                    $('.btn').toggle(2000);
                });


                function flashrow() {
                    $('.roww').removeClass("active");
                    $('.roww').addClass("active");
                }
                setInterval(flashrow, 1200);

            });

        </script>
        <div class="row justify-content-between">
            <div class="col-3">
                <h4>Hello, Dispatcher @ViewBag.UserLoggedIn.FirstName @ViewBag.UserLoggedIn.LastName</h4>
            </div>
            <div class="col-9 text-right">
                <h5><a asp-action="Logout">Logout</a></h5>
            </div>
        </div>

    </head>

    <body>






        <div class="row justify-content-center">
            <form asp-action="CreateIncident" asp-controller="Home" asp-method="post">
                <input class="btn btn-outline-danger btn-lg" type="submit" value="Create New Incident">
            </form>
        </div><br>
        <div class="row justify-content-center">

            <h3>Incidents</h3>

        </div>
        <div class="row justify-content-center">
            <div class="col-2">
                <div class="card available">
                    <div class="card-body">
                        <div class="row justify-content-center">

                            <h4>Available Units: </h4>&nbsp&nbsp&nbsp&nbsp
                            @foreach(var unit in @ViewBag.AvailableUnits)
                            {
                            <span><a asp-action="ViewUnit"
                                    asp-route-unitId=@unit.UnitId>@unit.NumberType@unit.Number,&nbsp
                                </a></span>
                            }

                        </div>
                    </div>
                </div>

            </div>
            <div class="col-6">
                <table class="table table-border-top">
                    <thead>
                        <tr>
                            <th >Incident Status</th>
                            <th >Incident ID</th>
                            <th style="vertical-align: top" >Incident Location</th>
                            <th >Incident Type</th>
                            <th >Units Responding (click to remove)</th>
                            <th style="vertical-align: top">Action</th>
                            <th style="vertical-align: top" >Dispatch</th>
                            <th >Incident Time/Date</th>
                        </tr>

                    </thead>
                    <!--Incident Table -->
                    <tbody>
                        @foreach(Incident inc in @Model.OrderByDescending(i=>i.CreatedAt))
                        {
                        @if(@inc.IsActive==false)
                        {
                        <tr class="complete">
                            <td>COMPLETE</td>
                            <td>@inc.IncidentId</td>
                            <td>@inc.Location</td>
                            <td>@inc.Type</td>
                            <td>

                            </td>
                            <td>Incident Complete-No Action Possible</td>
                            <td>Cannot Add Units</td>
                            <td>@inc.CreatedAt</td>
                        </tr>
                        }
                        else if(@inc.IsActive==true && inc.dispatchedUnits.Count()==0)
                        {
                        <tr class="blinking">
                            <td>AWAITING DISPATCH</td>
                            <td>@inc.IncidentId</td>
                            <td>@inc.Location</td>
                            <td>@inc.Type</td>
                            <td>
                                AWAITING DISPATCH
                            </td>
                            <td><a asp-action="ConfirmCompleteIncident" asp-route-incidentId="@inc.IncidentId">Mark
                                    Incident
                                    Complete</a>
                            </td>
                            <td><a asp-action="AddUnitToIncident" asp-route-incidentId="@inc.IncidentId">Add Units to
                                    Incident</a>
                            </td>
                            <td>@inc.CreatedAt</td>


                        </tr>
                        }
                        else if(@inc.IsActive==true)
                        {
                        <tr class="dispatched">
                            <td>DISPATCHED</td>
                            <td>@inc.IncidentId</td>
                            <td>@inc.Location</td>
                            <td>@inc.Type</td>
                            <td>
                                @foreach(var u in @inc.dispatchedUnits)
                                {
                                <span><a asp-action="ConfirmRemoval" asp-route-incidentId=@inc.IncidentId
                                        asp-route-unitId="@u.UnitDispatched.UnitId">@u.UnitDispatched.NumberType@u.UnitDispatched.Number</a></span>
                                }
                            </td>
                            <td><a asp-action="ConfirmCompleteIncident" asp-route-incidentId="@inc.IncidentId">Mark
                                    Incident
                                    Complete</a>
                            </td>
                            <td><a asp-action="AddUnitToIncident" asp-route-incidentId="@inc.IncidentId">Add Units to
                                    Incident</a>
                            </td>
                            <td>@inc.CreatedAt</td>


                        </tr>
                        }

                        }
                    </tbody>
                </table>
            </div>
            <!--end col-->
            <div class="col-2">
                <div class="row">
                    <div class="card">
                        <div class="card-body">
                            <div class="row justify-content-center">
                                <h4>All Units:</h4> &nbsp&nbsp&nbsp&nbsp
                                @foreach(var unit in @ViewBag.AllUnits)
                                {
                                <span><a asp-action="ViewUnit"
                                        asp-route-unitId=@unit.UnitId>@unit.NumberType@unit.Number,&nbsp
                                    </a></span>
                                }
                            </div>
                        </div>
                    </div>
                </div><br>
                <div class="row">
                    <div class="card on_call" style="width:100%">
                        <div class="card-body">
                            <div class="row justify-content-center">
                                <h4>On A Call:</h4> &nbsp&nbsp&nbsp&nbsp
                                @foreach(var unit in @ViewBag.UnitsOnCall)
                                {
                                <span><a asp-action="ViewUnit"
                                        asp-route-unitId=@unit.UnitId>@unit.NumberType@unit.Number,&nbsp
                                    </a></span>
                                }
                            </div>
                        </div>
                    </div>
                </div><br>
                <div class="row">
                        <div class="card " style="width:100%; height:150px;">
                            <div class="card-body">
                                <div class="row justify-content-center">
                                    <h4>Out Of Service:</h4> &nbsp&nbsp&nbsp&nbsp
                                    @foreach(var unit in @ViewBag.OOS)
                                    {
                                    <span><a asp-action="ViewUnit"
                                            asp-route-unitId=@unit.UnitId>@unit.NumberType@unit.Number,&nbsp
                                        </a></span>
                                    }
                                
                                </div>
                            </div>
                        </div>
                    </div>
            </div>

        </div>

        </div>
        <!--end row-->
        <div class="form-row justify-content-around">
            <div class="col-2">

                <form asp-action="CreateRescuer" asp-controller="Home" asp-method="post">
                    <input class="btn btn-outline-info btn-sm " type="submit" value="Create New Rescuer">
                </form>
            </div>

            <div class="col-2">
                <form asp-action="CreateUnit" asp-controller="Home" asp-method="post">
                    <input class="btn btn-outline-info btn-sm " type="submit" value="Create New Unit">
                </form>
            </div>

            <div class="col-2">
                <form asp-action="AvailablePersonnel" asp-controller="Home" asp-method="post">
                    <input class="btn btn-outline-info btn-sm " type="submit" value="View Available Personnel">
                </form>
            </div>

        </div><br>


        </div>
        </div>



        <style type="text/css">
            .active {
                background-color: rgb(196, 88, 88);

            }

            .dispatched {
                background-color: yellow;
            }

            .complete {
                background-color: slategray;
            }

            .blinking {
                animation: blinkingText 0.8s infinite;
            }

            @@keyframes blinkingText {
                0% {
                    background-color: red;
                }

                25% {
                    background-color: transparent;
                }

                50% {
                    background-color: transparent;
                }

                75% {
                    background-color: transparent;
                }

                100% {
                    background-color: red;
                }
            }

            .container-fluid {

                padding-left: 40px;
                padding-right: 40px;
                padding-top: 20px;
                padding-bottom: 20px;
            }

            .table_header {
                vertical-align: top;
            }

            td {
                color: black;
            }
            .available{
                background-color: rgb(150, 236, 150);
            }
            .on_call{
                background-color: yellow;
            }
            
            .card{
                margin-top: 20px;
                margin-bottom: 20px;
                margin-left: 20px;
                margin-right: 20px;
            }
        </style>



    </body>

    </html>